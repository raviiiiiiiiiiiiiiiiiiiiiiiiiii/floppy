<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bro Game Maker</title>
<style>
    body { font-family: Arial, sans-serif; background: #111; color: #fff; margin: 0; padding: 0; }
    #editor { width: 100%; height: 200px; background: #222; color: #0f0; border: none; padding: 10px; outline: none; }
    #canvasContainer { text-align: center; margin-top: 10px; }
    canvas { background: #000; border: 2px solid #0f0; }
    button { background: #0f0; color: #000; padding: 10px; border: none; cursor: pointer; margin: 5px; }
    button:hover { opacity: 0.7; }
</style>
</head>
<body>

<h2 style="text-align:center;">BRO GAME MAKER ðŸ”¥</h2>
<div style="padding:20px;">
    
    <textarea id="editor">// Example Game Script

player.x = 50
player.y = 50

onStart(() => {
  log("Game started bro!")
})

onUpdate(() => {
  if (keyDown('ArrowRight')) player.x += 2
  if (keyDown('ArrowLeft')) player.x -= 2
  if (keyDown('ArrowUp')) player.y -= 2
  if (keyDown('ArrowDown')) player.y += 2
})
    </textarea>

    <button onclick="runGame()">RUN GAME</button>
    <button onclick="location.reload()">RESET</button>

    <div id="canvasContainer">
        <canvas id="gameCanvas" width="500" height="300"></canvas>
    </div>
</div>

<script>
let ctx, player = {x:0, y:0}, keys = {};
let startCallbacks = [], updateCallbacks = [];
let gameRunning = false;

function onStart(cb) { startCallbacks.push(cb); }
function onUpdate(cb) { updateCallbacks.push(cb); }
function log(msg) { console.log("%c" + msg, "color: #0f0"); }

function keyDown(key) { return keys[key] === true; }

document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

function runCode(code) {
    startCallbacks = [];
    updateCallbacks = [];
    new Function(code)();
}

function startGame() {
    startCallbacks.forEach(cb => cb());
    gameRunning = true;
    gameLoop();
}

function gameLoop() {
    if (!gameRunning) return;
    
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    updateCallbacks.forEach(cb => cb());
    
    ctx.fillStyle = "red";
    ctx.fillRect(player.x, player.y, 30, 30);

    requestAnimationFrame(gameLoop);
}

function runGame() {
    const canvas = document.getElementById("gameCanvas");
    ctx = canvas.getContext("2d");

    let code = document.getElementById("editor").value;
    runCode(code);
    startGame();
}

</script>
</body>
</html>
